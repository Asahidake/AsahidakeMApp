var AsahidakeMap=function(e){"use strict";const t=window.matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)").matches,o=new ol.layer.Tile({source:new ol.source.XYZ(t?{url:"/map/tiles/2x/{z}/{x}/{y}.png",tilePixelRatio:2}:{url:"/map/tiles/{z}/{x}/{y}.png",tilePixelRatio:1}),extent:[15890800,5401150,15918700,5426850],interactive:!0}),r=new Map;function n(e){const t="/map/data/"+e;if(r.has(t))return r.get(t);try{const e=fetch(t).then(e=>e.json());return r.set(t,e),e}catch(e){console.error("The following error occured when loading geodata"),console.error(e)}}const l=new ol.format.GeoJSON;function s(e,t,o={}){return Promise.resolve(t).then(t=>{if(null===t||!Array.isArray(t.features)||t.features.length<1)return void e.set("title",null);const r=new ol.source.Vector({...o,features:l.readFeatures(t,{featureProjection:"EPSG:3857"})});e.setSource(r)})}function i(e,t=1){switch(e){case 1:return`rgba(62,119,200,${t})`;case 2:return`rgba(33,153,31,${t})`;case 3:return`rgba(255,202,0,${t})`;case 4:return`rgba(242,133,0,${t})`;case 5:return`rgba(235,25,60,${t})`;default:return`rgba(66,66,66,${t})`}}const a=["summit","nakadake","tennyoga","tennyogahara","loop"];let c=null;function u(e){const t=e.get("grade"),o=e.get("trails"),r=i(t,null===c||o.includes(c)?1:.5);return new ol.style.Style({stroke:new ol.style.Stroke({color:r,width:3})})}function g(e){return`\n  <svg width="1em" height="1em" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M0 50 H 100" stroke="${i(e)}" stroke-width="20" /></svg>\n  `}const w=[1,2,3,4,5].map((function(e){const t=new ol.layer.Vector({source:null,style:u,interactive:!0,title:`${g(e)} グレード ${e}`});return s(t,n("base.json").then(t=>function(e,t){if(void 0===e||!Array.isArray(e.features))return console.warn("Unable to filter trail features"),e;const o=e.features.filter(e=>e.properties.grade===t);return{...e,features:o}}(t.trails,e)),{attributions:'<a href="http://www.daisetsuzan.or.jp/">大雪山国立公園連絡協議会</a>'}),t})),f=new ol.style.RegularShape({radius:5,points:3,fill:new ol.style.Fill({color:"rgba(64, 64, 64, 1)"})});function h(e="jp"){return function(t){const o=t.get(e);if(null===o)return ol.style.Style({image:f});const r="jp"===e?'0.8em "ヒラギノ角ゴ Pro W6", "Hiragino Kaku Gothic Pro",Osaka, "メイリオ", Meiryo, "ＭＳ Ｐゴシック", "MS PGothic", sans-serif':"0.7em Arial Black, Arial, sans-serif",n=new ol.style.Text({font:r,text:o,textBaseline:"bottom",textAlign:"center",offsetX:0,offsetY:-7,placement:"point",maxAngle:0,fill:new ol.style.Fill({color:"rgba(64, 64, 64, 1)"}),stroke:new ol.style.Stroke({color:"rgba(255, 255, 255, 1)",width:3})});return new ol.style.Style({image:f,text:n})}}const y={declutter:!0,interactive:!0,type:"base"},d=new ol.layer.Vector({...y,style:h("jp"),title:"日本語"}),m=new ol.layer.Vector({...y,style:h("en"),title:"English",visible:!1}),p=n("base.json").then(e=>e.labels);s(d,p),s(m,p);function b(e="rgba(66, 66, 66, 1)"){return()=>new ol.style.Style({image:new ol.style.Circle({radius:5,fill:new ol.style.Fill({color:"rgba(255, 255, 255, 1)"}),stroke:new ol.style.Stroke({color:e,width:3})})})}function x(e,t="rgba(66, 66, 66, 1)"){return`<svg width="1em" height="1em" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><circle stroke="${t}" fill="#fff" stroke-width="20" cx="50" cy="50" r="40"></circle></svg> ${e}`}function k(e){const t=new ol.layer.Vector({declutter:!0,interactive:!0,style:b(e.color),title:x(e.title,e.color)});t.on("change",A);return s(t,n(e.source)),t}const v=k({source:"nakadake.json",title:"中岳温泉コース",color:"rgba(126,179,44,1)"}),j=k({source:"summit.json",title:"旭岳山頂コース",color:"rgba(255,202,0,1)"}),S=k({source:"loop.json",title:"一日周回コース",color:"rgba(242,133,0,1)"}),$=[k({source:"tennyoga.json",title:"天女ヶ原コース",color:"rgba(33,153,31,1)"}),S,v,j],P=new Map;function A(e){const t=e.target.getSource();if(null===t)return;const o=t.getFeatures();for(let e of o){const t=e.get("src"),o=e.getGeometry(),r=o instanceof ol.geom.Point?o.getCoordinates():void 0;P.set("/images/MapPics/"+t,r)}}const L=[];let M=null;function T(){null!==M&&clearTimeout(M),M=setTimeout(()=>{M=null,L.length>0&&L.forEach(e=>e())},200)}return $.forEach(e=>{e.on("change:source",T)}),e.baseTiles=o,e.enLabelsLayer=m,e.highlightTrail=function(e){a.includes(e)||(console.warn(`Can't highlight ${e}. No matching trail found`),c=null),c=e},e.jpLabelsLayer=d,e.onPhotosLoad=function(e){L.push(e)},e.photoLayers=$,e.photoLocations=P,e.trailLayers=w,e}({});
