var AsahidakeMap=function(e){"use strict";var t=window.matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)").matches,r=new ol.layer.Tile({source:new ol.source.XYZ(t?{url:"/map/tiles/2x/{z}/{x}/{y}.png",tilePixelRatio:2}:{url:"/map/tiles/{z}/{x}/{y}.png",tilePixelRatio:1}),extent:[15890800,5401150,15918700,5426850],interactive:!0});function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}var c=new Map;function s(e){var t="/map/data/"+e;if(c.has(t))return c.get(t);try{var r=fetch(t).then((function(e){return e.json()}));return c.set(t,r),r}catch(e){console.error("The following error occured when loading geodata"),console.error(e)}}var u=new ol.format.GeoJSON;function f(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Promise.resolve(t).then((function(t){if(null===t||!Array.isArray(t.features)||t.features.length<1)e.set("title",null);else{var n=new ol.source.Vector(a(a({},r),{},{features:u.readFeatures(t,{featureProjection:"EPSG:3857"})}));e.setSource(n)}}))}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;switch(e){case 1:return"rgba(62,119,200,".concat(t,")");case 2:return"rgba(33,153,31,".concat(t,")");case 3:return"rgba(255,202,0,".concat(t,")");case 4:return"rgba(242,133,0,".concat(t,")");case 5:return"rgba(235,25,60,".concat(t,")");default:return"rgba(66,66,66,".concat(t,")")}}var y=["summit","nakadake","tennyoga","tennyogahara","loop"],h=null;function w(e){var t=e.get("grade"),r=e.get("trails"),n=null===h||r.includes(h)?1:.5;return new ol.style.Style({stroke:new ol.style.Stroke({color:g(t,n),width:3})})}function v(e){var t=g(e);return'\n  <svg width="1em" height="1em" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M0 50 H 100" stroke="'.concat(t,'" stroke-width="20" /></svg>\n  ')}var p=[1,2,3,4,5].map((function(e){var t=new ol.layer.Vector({source:null,style:w,interactive:!0,title:"".concat(v(e)," グレード ").concat(e)});return f(t,s("base.json").then((function(t){return function(e,t){if(void 0===e||!Array.isArray(e.features))return console.warn("Unable to filter trail features"),e;var r=e.features.filter((function(e){return e.properties.grade===t}));return a(a({},e),{},{features:r})}(t.trails,e)})),{attributions:'<a href="http://www.daisetsuzan.or.jp/">大雪山国立公園連絡協議会</a>'}),t})),b="rgba(64, 64, 64, 1)",d=new ol.style.RegularShape({radius:5,points:3,fill:new ol.style.Fill({color:b})});function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"jp";return function(t){var r=t.get(e);if(null===r)return ol.style.Style({image:d});var n="jp"===e?'0.8em "ヒラギノ角ゴ Pro W6", "Hiragino Kaku Gothic Pro",Osaka, "メイリオ", Meiryo, "ＭＳ Ｐゴシック", "MS PGothic", sans-serif':"0.7em Arial Black, Arial, sans-serif",o=new ol.style.Text({font:n,text:r,textBaseline:"bottom",textAlign:"center",offsetX:0,offsetY:-7,placement:"point",maxAngle:0,fill:new ol.style.Fill({color:b}),stroke:new ol.style.Stroke({color:"rgba(255, 255, 255, 1)",width:3})});return new ol.style.Style({image:d,text:o})}}var j={declutter:!0,interactive:!0,type:"base"},x=new ol.layer.Vector(a(a({},j),{},{style:m("jp"),title:"日本語"})),k=new ol.layer.Vector(a(a({},j),{},{style:m("en"),title:"English",visible:!1})),O=s("base.json").then((function(e){return e.labels}));f(x,O),f(k,O);function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rgba(66, 66, 66, 1)";return function(){return new ol.style.Style({image:new ol.style.Circle({radius:5,fill:new ol.style.Fill({color:"rgba(255, 255, 255, 1)"}),stroke:new ol.style.Stroke({color:e,width:3})})})}}function P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rgba(66, 66, 66, 1)";return'<svg width="1em" height="1em" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><circle stroke="'.concat(t,'" fill="#fff" stroke-width="20" cx="50" cy="50" r="40"></circle></svg> ').concat(e)}function A(e){var t=new ol.layer.Vector({declutter:!0,interactive:!0,style:S(e.color),title:P(e.title,e.color)});return t.on("change",G),f(t,s(e.source)),t}var M=A({source:"nakadake.json",title:"中岳温泉コース",color:"rgba(126,179,44,1)"}),E=A({source:"summit.json",title:"旭岳山頂コース",color:"rgba(255,202,0,1)"}),L=A({source:"loop.json",title:"一日周回コース",color:"rgba(242,133,0,1)"}),T=[A({source:"tennyoga.json",title:"天女ヶ原コース",color:"rgba(33,153,31,1)"}),L,M,E],F=new Map;function G(e){var t=e.target.getSource();if(null!==t){var r,n=i(t.getFeatures());try{for(n.s();!(r=n.n()).done;){var o=r.value,a=o.get("src"),l=o.getGeometry(),c=l instanceof ol.geom.Point?l.getCoordinates():void 0;F.set("/images/MapPics/"+a,c)}}catch(e){n.e(e)}finally{n.f()}}}var V=[];var B=null;function C(){null!==B&&clearTimeout(B),B=setTimeout((function(){B=null,V.length>0&&V.forEach((function(e){return e()}))}),200)}return T.forEach((function(e){e.on("change:source",C)})),e.baseTiles=r,e.enLabelsLayer=k,e.highlightTrail=function(e){null===e||y.includes(e)||(console.warn("Can't highlight ".concat(e,". No matching trail found")),h=null),h=e,p.forEach((function(e){return e.changed()}))},e.jpLabelsLayer=x,e.onPhotosLoad=function(e){V.push(e)},e.photoLayers=T,e.photoLocations=F,e.trailLayers=p,e}({});
