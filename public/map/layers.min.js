var AsahidakeMap=function(e){"use strict";var t=window.matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)").matches,r=new ol.layer.Tile({source:new ol.source.XYZ(t?{url:"/map/tiles/2x/{z}/{x}/{y}.png",tilePixelRatio:2}:{url:"/map/tiles/{z}/{x}/{y}.png",tilePixelRatio:1}),extent:[15890800,5401150,15918700,5426850],interactive:!0});function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}var c=new Map;function u(e){var t="/map/data/"+e;if(c.has(t))return c.get(t);try{var r=fetch(t).then((function(e){return e.json()}));return c.set(t,r),r}catch(e){console.error("The following error occured when loading geodata"),console.error(e)}}var s=new ol.format.GeoJSON;function f(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Promise.resolve(t).then((function(t){if(null===t||!Array.isArray(t.features)||t.features.length<1)e.set("title",null);else{var n=new ol.source.Vector(a(a({},r),{},{features:s.readFeatures(t,{featureProjection:"EPSG:3857"})}));e.setSource(n)}}))}var g={kurodake:[15899228.890813727,5413063.7404938275,15912938.319705235,5422830.47369097],nakadake:[15899228.890813727,5413272.70665701,15903199.394036591,5416284.892751929],loop:[15899228.890813727,5413063.7404938275,15904526.157371525,5416403.292199796],tennyoga:[15896267.3550505,5411330.6321919765,15899383.076703139,5413272.70665701],summit:[15899228.890813727,5413063.7404938275,15902455.52199312,5413531.170369489],sugatami:[15899228.890813727,5413048.429889194,15900239.875193141,5413615.0496835755]};function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;switch(e){case 1:return"rgba(62,119,200,".concat(t,")");case 2:return"rgba(33,153,31,".concat(t,")");case 3:return"rgba(255,202,0,".concat(t,")");case 4:return"rgba(242,133,0,".concat(t,")");case 5:return"rgba(235,25,60,".concat(t,")");default:return"rgba(66,66,66,".concat(t,")")}}function y(e){var t=e.get("grade"),r=e.get("trails"),n=k.currentTrail,o=null===n||r.includes(n)?1:.5;return new ol.style.Style({stroke:new ol.style.Stroke({color:h(t,o),width:3})})}function w(e){var t=h(e);return'\n  <svg width="1em" height="1em" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M0 50 H 100" stroke="'.concat(t,'" stroke-width="20" /></svg>\n  ')}var p=[1,2,3,4,5].map((function(e){var t=new ol.layer.Vector({source:null,style:y,interactive:!0,title:"".concat(w(e)," グレード ").concat(e)}),r="grade".concat(e);return f(t,u("base.json").then((function(e){return e.trails[r]})),{attributions:'<a href="http://www.daisetsuzan.or.jp/">大雪山国立公園連絡協議会</a>'}),t})),v=Object.keys(g);function d(e){this.updateLayers=e,this.currentTrail=null}d.prototype.update=function(e){null===e||v.includes(e)||(console.warn("Can't highlight ".concat(e,". No matching trail found")),e=null),this.currentTrail=e,this.updateLayers.forEach((function(e){return e.changed()}))};for(var b=function(){var e=j[m];d.prototype[e]=function(){this.update(e)}},m=0,j=v;m<j.length;m++)b();d.prototype.clear=function(){this.update(null)};var k=new d(p),x="rgba(64, 64, 64, 1)",O=new ol.style.RegularShape({radius:5,points:3,fill:new ol.style.Fill({color:x})});function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"jp";return function(t){var r=t.get(e);if(null===r)return ol.style.Style({image:O});var n="jp"===e?'0.8em "ヒラギノ角ゴ Pro W6", "Hiragino Kaku Gothic Pro",Osaka, "メイリオ", Meiryo, "ＭＳ Ｐゴシック", "MS PGothic", sans-serif':"0.7em Arial Black, Arial, sans-serif",o=new ol.style.Text({font:n,text:r,textBaseline:"bottom",textAlign:"center",offsetX:0,offsetY:-7,placement:"point",maxAngle:0,fill:new ol.style.Fill({color:x}),stroke:new ol.style.Stroke({color:"rgba(255, 255, 255, 1)",width:3})});return new ol.style.Style({image:O,text:o})}}var P={declutter:!0,interactive:!0,type:"base"},A=new ol.layer.Vector(a(a({},P),{},{style:S("jp"),title:"日本語"})),L=new ol.layer.Vector(a(a({},P),{},{style:S("en"),title:"English",visible:!1})),T=u("base.json").then((function(e){return e.labels}));f(A,T),f(L,T);function M(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rgba(66, 66, 66, 1)";return function(){return new ol.style.Style({image:new ol.style.Circle({radius:5,fill:new ol.style.Fill({color:"rgba(255, 255, 255, 1)"}),stroke:new ol.style.Stroke({color:e,width:3})})})}}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rgba(66, 66, 66, 1)";return'<svg width="1em" height="1em" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><circle stroke="'.concat(t,'" fill="#fff" stroke-width="20" cx="50" cy="50" r="40"></circle></svg> ').concat(e)}function F(e){var t=new ol.layer.Vector({declutter:!0,interactive:!0,style:M(e.color),title:E(e.title,e.color)});return t.on("change",z),f(t,u(e.source)),t}var G=F({source:"nakadake.json",title:"中岳温泉コース",color:"rgba(126,179,44,1)"}),V=F({source:"summit.json",title:"旭岳山頂コース",color:"rgba(255,202,0,1)"}),B=F({source:"loop.json",title:"一日周回コース",color:"rgba(242,133,0,1)"}),C=[F({source:"tennyoga.json",title:"天女ヶ原コース",color:"rgba(33,153,31,1)"}),B,G,V],D=new Map;function z(e){var t=e.target.getSource();if(null!==t){var r,n=i(t.getFeatures());try{for(n.s();!(r=n.n()).done;){var o=r.value,a=o.get("src"),l=o.getGeometry(),c=l instanceof ol.geom.Point?l.getCoordinates():void 0;D.set("/images/MapPics/"+a,c)}}catch(e){n.e(e)}finally{n.f()}}}var I=[];var R=null;function H(){null!==R&&clearTimeout(R),R=setTimeout((function(){R=null,I.length>0&&I.forEach((function(e){return e()}))}),200)}return C.forEach((function(e){e.on("change:source",H)})),e.baseTiles=r,e.enLabelsLayer=L,e.extents=g,e.highlight=k,e.jpLabelsLayer=A,e.onPhotosLoad=function(e){I.push(e)},e.photoLayers=C,e.photoLocations=D,e.trailLayers=p,e}({});